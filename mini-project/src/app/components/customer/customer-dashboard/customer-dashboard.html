<div class="dashboard-container">

  <!-- TOP CATEGORY BAR -->
  <div class="category-bar">
    <button
      *ngFor="let cat of categories"
      class="category-pill"
      [class.active]="selectedCategory === cat"
      (click)="selectCategory(cat)"
    >
      {{ cat | titlecase }} Insurance
    </button>
  </div>

  <!-- MAIN CONTENT -->
  <main class="content full-width">

    <!-- ================= POLICY GRID ================= -->
    <section
      class="policy-grid fade-in"
      *ngIf="!selectedPolicy"
    >
      <h2 class="section-title">
        Available {{ selectedCategory | titlecase }} Plans
      </h2>

      <div class="cards-container">
        <div class="policy-card" *ngFor="let policy of filteredPolicies">

          <div class="card-header">
            <h4>{{ policy.name }}</h4>
            <span class="badge">{{ policy.status }}</span>
          </div>

          <div class="card-body">
            <p class="mb-2 text-sm font-semibold">{{ policy.id }}</p>
            <p class="desc">{{ policy.description }}</p>

            <div class="key-stats">
              <div class="stat">
                <span class="label">Premium</span>
                <span class="value">‚Çπ{{ policy.premium | number }}</span>
              </div>
              <div class="stat">
                <span class="label">Coverage</span>
                <span class="value">‚Çπ{{ policy.sumInsured | number }}</span>
              </div>
              <div class="stat">
                <span class="label">Duration</span>
                <span class="value">{{ policy.duration }} Days</span>
              </div>
            </div>

            <ul class="features-preview">
              <li *ngFor="let feat of policy.features.slice(0, 3)">
                ‚úÖ {{ feat }}
              </li>
            </ul>
          </div>

          <div class="card-footer">
            <button class="btn-details" (click)="viewPolicyDetails(policy)">
              View Details
            </button>
            <a href="/customer/policy-request" class="btn-buy">
              Proceed to Buy
            </a>
          </div>

        </div>
      </div>
    </section>

    <!-- ================= POLICY DETAILS ================= -->
    <section
      class="policy-details fade-in"
      *ngIf="selectedPolicy"
    >

      <button class="back-btn" (click)="closeDetails()">
        ‚Üê Back to {{ selectedCategory | titlecase }} Plans
      </button>

      <!-- HEADER -->
      <div class="detail-header">
        <h1>{{ selectedPolicy.name }}</h1>
        <div class="price-tag">
          ‚Çπ{{ selectedPolicy.premium | number }}
          <small>/ year</small>
        </div>
      </div>

      <!-- CONTENT GRID -->
      <div class="detail-grid">

        <div class="section">
          <h3>Highlights</h3>
          <p>{{ selectedPolicy.description }}</p>

          <ul class="detail-list">
            <li><strong>Sum Insured:</strong> ‚Çπ{{ selectedPolicy.sumInsured | number }}</li>
            <li><strong>Entry Age:</strong> {{ selectedPolicy.minEntryAge }} ‚Äì {{ selectedPolicy.maxEntryAge }} Years</li>
            <li><strong>Waiting Period:</strong> {{ selectedPolicy.waitingPeriod }} Days</li>
            <li><strong>Co-Pay:</strong> {{ selectedPolicy.coPay }}%</li>
            <li><strong>Claim Ratio:</strong> {{ selectedPolicy.claimRatio }}%</li>
          </ul>
        </div>

        <div class="section">
          <h3>Key Benefits</h3>
          <ul class="check-list">
            <li *ngFor="let benefit of selectedPolicy.keyBenefits">
              ‚ú® {{ benefit }}
            </li>
          </ul>
        </div>

        <div class="section full-width">
          <h3>Exclusions</h3>
          <ul class="cross-list">
            <li *ngFor="let exc of selectedPolicy.exclusions">
              ‚ùå {{ exc }}
            </li>
          </ul>
        </div>

        <div class="section full-width" *ngIf="selectedPolicy.networkHospitals?.length">
          <h3>Network Hospitals</h3>
          <div class="tags">
            <span class="tag" *ngFor="let hosp of selectedPolicy.networkHospitals">
              üè• {{ hosp }}
            </span>
          </div>
        </div>

        <div class="section full-width" *ngIf="selectedPolicy.renewalProcess">
          <h3>Renewal Process</h3>
          <p>{{ selectedPolicy.renewalProcess }}</p>
        </div>

      </div>

      <!-- ACTIONS -->
      <div class="actions">
        <a
          *ngIf="selectedPolicy.brochureUrl"
          [href]="selectedPolicy.brochureUrl"
          target="_blank"
          class="btn-secondary"
        >
          Download Brochure
        </a>

        <a href="/customer/policy-request" class="btn-primary">
          Proceed to Buy
        </a>
      </div>

    </section>

  </main>
</div>
